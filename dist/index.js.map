{"version":3,"sources":["webpack:///webpack/bootstrap 6ed934ca6cfa221f967f","webpack:///./src/index.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/file.js","webpack:///./src/emitter.js","webpack:///./src/compress.js"],"names":["Compress","options","defaultOptions","inputSelector","downloadSelector","imageSelector","changeFn","dropFn","dropSelector","rate","imagePrefix","dimen","compressFn","rateSelector","rateEvent","rateFn","option","Object","assign","inputElem","Array","from","document","querySelectorAll","dropElem","emitter","forEach","el","addEventListener","ev","dimension","on","eventName","callback","global","g","Function","eval","e","window","module","exports","extra","getImageUrl","getFile","files","target","dataTransfer","event","emit","reader","FileReader","count","filesUrl","onload","push","result","readAsDataURL","file","Emitter","_events","args","cb","mainCanvas","createElement","createImages","map","image","Image","src","url","width","height","compress","canvas","context","getContext","drawImage","toDataURL","compressAll","fileUrl","images"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dists/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6ed934ca6cfa221f967f","/**\n * Created by kayslay on 6/28/17.\n */\n\nimport fileListener from './file'\nimport Emitter from './emitter'\nimport compress from './compress'\n\nfunction Compress(options) {\n\tconst defaultOptions = {\n\t\tinputSelector: '#input_cmprss',\n\t\tdownloadSelector: '#comp_download',\n\t\timageSelector: '#comp_img',\n\t\tchangeFn: null,\n\t\tdropFn: null,\n\t\tdropSelector: null,\n\t\trate: 50,\n\t\timagePrefix: 'compressed-',\n\t\tdimen: null,\n\t\tcompressFn: null,\n\t\trateSelector: '#comp_rate',\n\t\trateEvent: 'change',\n\t\trateFn: null\n\t};\n\n\tconst option = Object.assign({}, defaultOptions, options)\n\n\tconst inputElem = Array.from(document.querySelectorAll(option.inputSelector));\n\tconst dropElem = Array.from(document.querySelectorAll(option.dropSelector));\n\tconst emitter = new Emitter();\n\n\tinputElem.forEach(el => {\n\t\t\"use strict\";\n\t\tel.addEventListener('change', (ev) => {\n\t\t\tfileListener(ev, emitter, {rate: option.rate, dimension: option.dimen})\n\t\t})\n\t});\n\tdropElem.forEach(el => {\n\t\t\"use strict\";\n\t\tel.addEventListener('dr', (ev) => {\n\t\t\tfileListener(ev, emitter, {rate: option.rate, dimension: option.dimen})\n\t\t})\n\t});\n\n\n\n\n\treturn {\n\t\ton(eventName, callback) {\n\t\t\temitter.on(eventName, callback)\n\t\t}\n\t}\n\n}\n\nglobal.Compress = Compress;\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","/**\n *\n * @param {Event} e\n * @param {Emitter} emitter\n * @returns {Array}\n */\nfunction getFile(e, emitter) {\n\tconst files = Array.from(e.target.files || e.dataTransfer.files);\n\n\tconst event = e.target.files ? \"changed\" : \"dropped\";\n\temitter.emit(event, files);\n\treturn files\n}\n\n//todo: is there a need to convert it to a arraybuffer or just use the url directly\n//todo: add support for multiple images\n/**\n *\n * @param files\n * @param emitter\n */\nfunction getImageUrl(files, emitter, ...extra) {\n\tconst reader = new FileReader();\n\tlet count = 0;\n\tlet filesUrl = [];\n\treader.onload = function () {\n\t\tcount--;\n\t\tfilesUrl.push(reader.result);\n\t\tif (count === 0) {\n\t\t\temitter.emit('readImageUrl', filesUrl, emitter, ...extra)\n\t\t}\n\t};\n\tfiles.forEach(file => {\n\t\tcount++;\n\t\treader.readAsDataURL(file)\n\t})\n}\n\nexport default function (e, emitter, ...extra) {\n\tgetImageUrl(getFile(e, emitter), emitter, ...extra)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/file.js","export default class Emitter{\n\n\tconstructor(){\n\t\tthis._events = {}\n\t}\n\n\ton(eventName, callback){\n\t\tconst event = this._events;\n\t\tevent[eventName] = event[eventName] || [];\n\t\tevent[eventName].push(callback);\n\t}\n\n\temit(eventName,...args){\n\t\tconst event = this._events\n\t\tif(!(eventName in event)) return false\n\n\t\tevent[eventName].forEach(cb=>cb(...args))\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/emitter.js","/**\n * Created by kayslay on 6/28/17.\n */\n\nconst mainCanvas = document.createElement('canvas');\n\nfunction createImages(filesUrl, dimension) {\n\t\"use strict\";\n\treturn filesUrl.map(url => {\n\t\tlet image = new Image();\n\t\timage.src = url;\n\t\treturn {image: image, dimension: Object.assign({}, dimension || {width: image.width, height: image.height})}\n\t})\n}\n\nfunction compress(image, rate) {\n\tconst canvas = mainCanvas;\n\tconst context = canvas.getContext('2d');\n\tcontext.drawImage(image.image,0,0,image.width,image.height);\n\treturn (canvas.toDataURL(\"image/jpeg\", (rate / 120)));\n}\n\nfunction compressAll(fileUrl,emitter,{rate,dimension}) {\n\tconst images = createImages(fileUrl,dimension);\n\temitter.emit(\"compressed\",images.map(image=>compress(image,rate)))\n}\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/compress.js"],"sourceRoot":""}