var file=angular.module("file",[]);file.factory("$file",function(){var c=[],a=[],d={};function f(u){for(var t in u){d.$fileList[t]=u[t]}}function h(t){return t.files}function g(){return c.length}function l(t,u){t.readAsDataURL(u);t.onload=function(){var v=d.$fileList.indexOf(u);d.$fileSrc[v]=t.result;d.scope.$apply(function(){d.scope.src=d.$fileSrc[v];var w=document.querySelector("#oriImg");w.onload=function(){d.scope.$apply(q(w))}})}}function q(u){var v=document.createElement("canvas");var w=v.getContext("2d"),y=new Image();y.src=u.src;var x=v.width=u.width;var t=v.height=u.height;w.drawImage(y,0,0,x,t);console.log((d.scope.rate/80));d.scope.comp=v.toDataURL("image/jpeg",(d.scope.rate/80))}function i(t){return t.name}function k(t){return t.type}function e(t){return t.size}function p(t){return t.lastModifiedDate}function b(u){var t=this.$fileList.indexOf(u);return this.$fileSrc[t]}function r(t){return t.target.files}function j(t){try{t.dataTransfer.dropEffect="copy";return t.dataTransfer.files}catch(t){console.log(t)}}function s(u){var t;u.preventDefault();if(u.type=="change"){t=r(u)}else{t=j(u)}f(t);l(d.reader,d.$fileList[0])}function n(t){t.addEventListener("change",s,false)}function m(t){t.addEventListener("drop",s,false)}function o(v,t,u){this.scope=v;try{n(t)}catch(w){console.log("no change element specified")}try{m(u)}catch(w){console.log("no drop element found")}return this}return d={init:o,$fileList:[],$fileSrc:[],insertSrc:function(){return b(this.$fileList[0])},getName:function(){return i(this.$fileList[0])},getsize:function(){return e(this.$fileList[0])},getType:function(){return k(this.$fileList[0])},getLastModDate:function(){return p(this.$fileList[0])},reader:new FileReader(),compress:q,imgTag:document.querySelector("#oriImg")}});